# GraphQL for Lernfair

We try to leverage GraphQL as a query language for our API. 
Maybe we're able to reduce complexity a bit with that (a lot of repetition in CRUD endpoints, a lot of data "massaging", missing authorizations / validations). 

We're using ApolloGraphQL as the runtime implementation, TypeGraphQL to automatically turn Typescript types into GraphQL Schemas, and TypeGraphQL-Prisma to automatically generate simple CRUD Mutations from the Prisma (database) Schema. Prisma is our ORM (alongside TypeORM, thus `npx prisma introspect` needs to be run once in a while to keep the schemas in sync). 

To rebuild the Prisma runtime and autogenerated TypeGraphQL types (found in `/graphql/generated/`) run `npx prisma generate` (this is also run as part of the build pipeline). 

The GraphQL can be explored when visiting `https://[backend-host]/apollo` which shows an interactive UI. Add `{ "authorization": "[SECRET ACCESS TOKEN]" }` to the HTTP Headers field, then you should be able to perform a query like:

```gql
query {  
  pupils(where: { firstname: { contains: "M" } }) { 
  	id  
    firstname
    lastname
  } 
}
```

- [Learn GraphQL](https://graphql.org/learn/)
- [Apollo Documentation](https://www.apollographql.com/docs/apollo-server/)
- [TypegraphQL Documentation](https://typegraphql.com/docs/introduction.html)
- [TypeGraphQL Prisma](https://github.com/MichalLytek/typegraphql-prisma)

## Writing your own mutation

